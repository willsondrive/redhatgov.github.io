<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>Exercise 1.19 - Ansible Inside | Red Hat | Public Sector</title>

    
    
    <link rel="stylesheet" href="/node_modules/patternfly/dist/css/patternfly.min.css" />
    <link rel="stylesheet" href="/node_modules/patternfly/dist/css/patternfly-additions.min.css" />

    
    <link rel="stylesheet" href="/node_modules/highlight.js/styles/darkula.css" />

    
    <link rel="stylesheet" href="/css/main.css" />
    <link rel="stylesheet" href="/css/asciidoc.css" />
    <link rel="stylesheet" href="/css/custom.css" />
    
    <script id="adobe_dtm" src="//www.redhat.com/dtm.js" type="text/javascript"></script>

    
    <script src="/node_modules/patternfly/node_modules/jquery/dist/jquery.min.js"></script>

    
    <script src="/node_modules/patternfly/node_modules/bootstrap/dist/js/bootstrap.min.js"></script>

    
    <script src="/node_modules/patternfly/node_modules/c3/c3.min.js"></script>
    <script src="/node_modules/patternfly/node_modules/d3/d3.min.js"></script>

    
    
    <script src="/node_modules/patternfly/node_modules/datatables/media/js/jquery.dataTables.min.js"></script>
    <script src="/node_modules/patternfly/node_modules/drmonty-datatables-colvis/js/dataTables.colVis.js"></script>
    <script src="/node_modules/patternfly/node_modules/datatables.net-colreorder/js/dataTables.colReorder.js"></script>

    
    
    <script src="/node_modules/patternfly/dist/js/patternfly.min.js"></script>

    
    <script src="/node_modules/patternfly/node_modules/patternfly-bootstrap-combobox/js/bootstrap-combobox.js"></script>

    
    <script src="/node_modules/patternfly/node_modules/bootstrap-datepicker/dist/js/bootstrap-datepicker.min.js"></script>

    
    <script src="/node_modules/patternfly/node_modules/moment/min/moment.min.js"></script>

    
    <script src="/node_modules/patternfly/node_modules/eonasdan-bootstrap-datetimepicker/build/js/bootstrap-datetimepicker.min.js"></script>

    
    <script src="/node_modules/patternfly/node_modules/bootstrap-select/dist/js/bootstrap-select.min.js"></script>

    
    <script src="/node_modules/patternfly/node_modules/bootstrap-switch/dist/js/bootstrap-switch.min.js"></script>

    
    <script src="/node_modules/patternfly/node_modules/bootstrap-touchspin/dist/jquery.bootstrap-touchspin.min.js"></script>

    
    <script src="/node_modules/patternfly/node_modules/patternfly-bootstrap-treeview/dist/bootstrap-treeview.min.js"></script>

    
    <script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>

    
    <script src="/node_modules/patternfly/node_modules/jquery-match-height/dist/jquery.matchHeight-min.js"></script>
    
    <script src="/js/clipboard.min.js"></script>
    <script src="/js/clip.js"></script>
    
    <script src="/node_modules/highlight.js/lib/highlight.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </head>
  <body class="">
    

<nav class="navbar navbar-default navbar-inverse navbar-fixed-top " role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse-1">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">
        <img src="/img/brand.png" alt="Red Hat | Public Sector" />
      </a>
    </div>
    <div class="collapse navbar-collapse navbar-collapse-1">
      <ul class="nav navbar-nav navbar-right">
        
        
          
            <li>
              <a href="/">Home</a>
            </li>
          
        
          
            <li>
              <a href="/about/">About</a>
            </li>
          
        
          
            <li>
              <a href="/contact/">Contact</a>
            </li>
          
        
          
            <li>
              <a href="/events/">Events</a>
            </li>
          
        
          
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                Workshops <b class="caret"></b>
              </a>
              <ul class="dropdown-menu">
                
                  <li>
                    <a href="/workshops/agile_integrations_ci/">Agile Integrations Workshop - Citizen Integrator</a>
                  </li>
                
                  <li>
                    <a href="/workshops/agile_integrations_dev/">Agile Integrations Workshop - Developer</a>
                  </li>
                
                  <li>
                    <a href="/workshops/ansible_tower/">Ansible Tower Workshop</a>
                  </li>
                
                  <li>
                    <a href="/workshops/ansible_tower_azure/">Ansible Tower Workshop on Azure</a>
                  </li>
                
                  <li>
                    <a href="/workshops/cloudforms41/">CloudForms Workshops</a>
                  </li>
                
                  <li>
                    <a href="/workshops/security_containers/">Container Security Workshop</a>
                  </li>
                
                  <li>
                    <a href="/workshops/containers_101/">Containers 101 Workshop</a>
                  </li>
                
                  <li>
                    <a href="/workshops/secure_software_factory/">DevSecOps Workshop - Secure Software Factory</a>
                  </li>
                
                  <li>
                    <a href="/workshops/example/">Example Workshop</a>
                  </li>
                
                  <li>
                    <a href="/workshops/jdv_dev/">JBoss Data Virtualization Development</a>
                  </li>
                
                  <li>
                    <a href="/workshops/strangling_the_monolith/">Microservices Workshop - Strangling the Monolith</a>
                  </li>
                
                  <li>
                    <a href="/workshops/openshift_101_dcmetromap/">OpenShift 101 - DC Metro Map Workshop</a>
                  </li>
                
                  <li>
                    <a href="/workshops/openshift_install/">OpenShift Install</a>
                  </li>
                
                  <li>
                    <a href="/workshops/security_openshift/">OpenShift Security Workshop</a>
                  </li>
                
                  <li>
                    <a href="/workshops/rhosp_101/">Red Hat OpenStack Platform 101</a>
                  </li>
                
                  <li>
                    <a href="/workshops/source_to_image/">Source to Image</a>
                  </li>
                
              </ul>
            </li>
          
        
      </ul>
    </div>
  </div>
</nav>



<div class="jumbotron jumbotron-page text-center">
  <h1>Exercise 1.19 - Ansible Inside</h1>
</div>

<div class="container">
  <div class="row">
    <p class="text-center">
      
      <a href="http://redhatgov.io/workshops/cloudforms41">Return to Workshop</a>
    </p>
    
    







<nav>
  <ul class="pager">
    
      <li class="previous">
        <a href="http://redhatgov.io/workshops/cloudforms41/exercise1.18/">&larr; Previous: Exercise 1.18 - “Hello, World!” Automation Script</a>
      </li>
    
    
      <li class="next">
        <a href="http://redhatgov.io/workshops/cloudforms41/exercise1.20/">Next: Exercise 1.20 - Ansible Tower &rarr;</a>
      </li>
    
  </ul>
</nav>


    

<h1 id="exercise-1-19-ansible-inside">Exercise 1.19 - Ansible Inside</h1>

<h2 id="exercise-description">Exercise Description</h2>

<p>Red Hat Ansible integration delivers out-of-the-box support for backing service, alert and policy actions using Ansible playbooks. Sync your existing playbook repositories with CloudForms, add credentials to access providers, and create service catalog items for actions ranging from creating and retiring VMs, updating security software, or adding additional disks when space runs low.</p>

<p>Ansible integrates with Red Hat CloudForms to provide automation solutions, using playbooks, for Service, Policy and Alert actions. Ansible playbooks consist of series of plays or tasks that define automation across a set of hosts, known as the inventory.</p>

<p>Ranging from simple to complex tasks, Ansible playbooks can support cloud management:</p>

<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>

<tbody>
<tr>
<td>Services</td>
<td>Allow a playbook to back a CloudForms service catalog item.</td>
</tr>

<tr>
<td>Control Actions</td>
<td>CloudForms policies can execute playbooks as actions based on events from providers.</td>
</tr>

<tr>
<td>Control Alerts</td>
<td>Set a playbook to launch prompted by a CloudForms alert.</td>
</tr>
</tbody>
</table>

<h2 id="section-1-enable-ansible-role">Section 1: Enable Ansible Role</h2>

<p>


  <div class="alert alert-success">
    
    <span class="pficon pficon-ok"></span>
    <p>This should already be done for you.</p>

  </div>


In Red Hat CloudForms, the Ansible role is disabled by default. Navigate to the settings
menu, then Configuration → Settings and select the desired server under Zones. Set
the Server Role for Embedded Ansible to On to enable the role.</p>

<h2 id="section-2-configuration">Section 2: Configuration</h2>

<h3 id="step-1-select-configuration">Step 1. Select Configuration</h3>

<p><img src="../images/configure.png" width="300" /></p>

<h3 id="step-2-click-embedded-ansible-on">Step 2. Click Embedded Ansible -&gt; On</h3>




  <div class="alert alert-success">
    
    <span class="pficon pficon-ok"></span>
    <p>This should already be done for you.</p>

  </div>



<p><img src="../images/configure2.png" width="1000" /></p>

<p><img src="../images/configure3.png" width="650" /></p>

<h3 id="step-3-click-automate-ansible">Step 3. Click Automate -&gt; Ansible</h3>

<p>You will now see Ansible Playbooks.  These playbooks are samples from <a href="https://github.com/jeromemarc/workflow-demo">GitHub</a></p>

<p><img src="../images/ansible-playbooks.png" width="1000" /></p>

<h2 id="section-3-playbook">Section 3: Playbook</h2>

<h3 id="step-1-explore-the-first-playbook">Step 1. Explore the first Playbook</h3>

<pre><code class="language-bash">ManageIQ/create_user.yml
</code></pre>

<p>From here we can see properties such as when it was uploaded and where the playbook came from.
<img src="../images/ansible-playbooks2.png" width="1000" /></p>

<p>If you click on &quot;Repository&quot; you can see even more detail about the Playbook.</p>

<p><img src="../images/ansible-playbooks3.png" width="1000" /></p>

<p>Ansible is built into CloudForms so there is nothing to install.</p>

<table>
<thead>
<tr>
<th>The basic workflow when using Ansible in Red Hat CloudForms is as follows:</th>
<th></th>
</tr>
</thead>

<tbody>
<tr>
<td>1. Add a source control repository that contains your playbooks.</td>
<td></td>
</tr>

<tr>
<td>2. Establish credentials with your inventory.</td>
<td></td>
</tr>

<tr>
<td>3. Back your services, alerts and policies using available playbooks.</td>
<td></td>
</tr>
</tbody>
</table>

<h3 id="step-2-add-credentials">Step 2. Add Credentials</h3>

<p>Red Hat CloudForms can store credentials used by playbooks. Credentials saved in CloudForms are matched and executed with a playbook when run.</p>

<p><img src="../images/ansible-creds.png" width="1000" /></p>

<pre><code class="language-bash">Automate / Ansible / Credentials
</code></pre>

<h3 id="step-3-explore-adding-a-new-credential">Step 3. Explore adding a new credential</h3>

<p>From here you would add a credential adding the Name and Type and actual credential.</p>

<p><img src="../images/ansible-creds2.png" width="650" /></p>

<h3 id="step-4-explore-your-new-ansible-service">Step 4. Explore your new Ansible Service</h3>

<pre><code class="language-bash">Services / My Services / Create CloudForms User
</code></pre>

<p><img src="../images/ansible-create.png" width="1000" /></p>

<p><img src="../images/ansible-create2.png" width="1000" /></p>

<p>Now this Ansible Playbook can be offered up as a Service item with CloudForms controlling the access and lifecycle of the automation action.</p>

<h1 id="summary">Summary</h1>

<p>In this exercise we’ve seen how simple it is to add and use Ansible Playbooks. Ansible with it's 1300+ modules makes the sky the limit when it comes to automation actions you can perform or offer up as a service in CloudForms.</p>


    







<nav>
  <ul class="pager">
    
      <li class="previous">
        <a href="http://redhatgov.io/workshops/cloudforms41/exercise1.18/">&larr; Previous: Exercise 1.18 - “Hello, World!” Automation Script</a>
      </li>
    
    
      <li class="next">
        <a href="http://redhatgov.io/workshops/cloudforms41/exercise1.20/">Next: Exercise 1.20 - Ansible Tower &rarr;</a>
      </li>
    
  </ul>
</nav>


    <p class="text-center">
      
      <a href="http://redhatgov.io/workshops/cloudforms41">Return to Workshop</a>
    </p>
  </div>
</div>

    <div id="page-footer" class="container">
      <p class="text-center">
        Copyright &copy; 2019 Red Hat, Inc.
      </p>
    </div>
    <script type="text/javascript">
      if (("undefined" !== typeof _satellite) && ("function" === typeof _satellite.pageBottom)) {
          _satellite.pageBottom();
      }
    </script>
  </body>
</html>

